{% extends 'indexSesion.html' %} {% block contenido %}
<section class="banner_main">
  <!-- Button trigger modal -->
  <br />
  <div class="grid text-center" style="--bs-columns: 3">
    <div></div>
    <div>
      <button
        type="button"
        class="btn btn-primary"
        data-bs-toggle="modal"
        data-bs-target="#exampleModal"
      >
        Ver Resultados
      </button>
    </div>
  </div>
  <br />

  <div class="container text-center">
    <div class="row">
      <div class="col"></div>
      <div class="col-10">
        <div class="columns">
          <div class="column">
            <h3 class="is-size-3">Controles</h3>
            {% for trats, foto_base64 in trat %}
            <div class="accordion col-sm-12" id="accordionFlushExample">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-heading{{trats[0]}}">
                  <button
                    class="accordion-button collapsed"
                    type="button"
                    data-bs-toggle="collapse"
                    data-bs-target="#flush-collapse{{trats[0]}}"
                    aria-expanded="false"
                    aria-controls="flush-collapse{{trats[0]}}"
                  >
                    {{trats[1]}}
                  </button>
                </h2>
                <div
                  id="flush-collapse{{trats[0]}}"
                  class="accordion-collapse collapse"
                  aria-labelledby="flush-heading{{trats[0]}}"
                  data-bs-parent="#accordionFlushExample"
                >
                  <div class="accordion-body">
                    <div class="container text-center">
                      <!--<div class="row">
                                                          <div class="form-floating mb-3">
                                                            <input type="date" name="fechaI1" class="form-control" placeholder="name@example.com" oninput="duplicarFecha(this.value)" required>
                                                            <label for="floatingInput">Fecha en la empezará a aplicar el control</label>
                                                         </div>
                                                        </div>-->
                      <div class="row">
                        <div class="col-sm">
                          <h4 style="text-align: justify; font-weight: bold">
                            Dosis recomendadas
                          </h4>
                          {% set partes = trats[3].split('+') %}
                          <ul style="text-align: justify">
                            {% for parte in partes %}
                            <li type="square">{{ parte }}</li>
                            {% endfor %}
                          </ul>
                          <br />
                          <h4 style="text-align: justify; font-weight: bold">
                            Días hasta el siguiente seguimiento al aplicar el
                            control
                          </h4>
                          <p style="text-align: justify">{{trats[4]}}</p>
                          <br />
                          <h4 style="text-align: justify; font-weight: bold">
                            Descripción y forma de aplicación del control
                          </h4>
                          <p style="text-align: justify">{{trats[7]}}</p>
                        </div>

                        <div class="col-sm">
                          <img
                            src="data:image/jpeg;base64,{{ foto_base64 }}"
                            width="100%"
                          /><br /><br />
                        </div>

                        {% if trats[0]==19 %}
                        <form
                          action="/regisSegui"
                          id="regisSegui"
                          method="POST"
                          enctype="multipart/form-data"
                        >
                          <input
                            type="hidden"
                            name="csrf_token"
                            value="{{ csrf_token() }}"
                          />
                          <input type="hidden" name="id" value="{{trats[0]}}" />
                          <input
                            type="hidden"
                            name="id_hoja"
                            value="{{id_hoja}}"
                          />
                          <input
                            type="hidden"
                            name="diagnostico"
                            value="{{pred_output}}"
                          />
                          <input
                            type="hidden"
                            name="porcen_fia"
                            value="{{porc}}"
                          />
                          <input
                            type="hidden"
                            name="imagen_hoja"
                            value="{{ti[0][2]}}"
                            style="display: none"
                          />
                          <!--<input type="submit" class="btn btn-primary"  value="Seleccionar" disabled>-->
                          <button
                            type="submit"
                            name="selControl"
                            class="btn btn-primary"
                          >
                            Seleccionar
                          </button>
                        </form>
                        {% elif trats[0]==17 %}
                        <form
                          action="/regisSegui"
                          id="regisSegui"
                          method="POST"
                          enctype="multipart/form-data"
                        >
                          <input
                            type="hidden"
                            name="csrf_token"
                            value="{{ csrf_token() }}"
                          />
                          <input type="hidden" name="id" value="{{trats[0]}}" />
                          <input
                            type="hidden"
                            name="id_hoja"
                            value="{{id_hoja}}"
                          />
                          <input
                            type="hidden"
                            name="diagnostico"
                            value="{{pred_output}}"
                          />
                          <input
                            type="hidden"
                            name="porcen_fia"
                            value="{{porc}}"
                          />
                          <!--<input type="hidden" name="imagen_hoja" value="{{ti[0][2]}}" style="display: none;">
                                                          <input type="submit" class="btn btn-primary"  value="Seleccionar" disabled>-->
                          <button
                            type="submit"
                            name="selControl"
                            class="btn btn-primary"
                          >
                            Seleccionar
                          </button>
                        </form>
                        {% else %}
                        <form
                          action="/regisSegui"
                          id="regisSegui"
                          method="POST"
                          enctype="multipart/form-data"
                        >
                          <div class="row">
                            <div class="col-sm-6">
                              <div class="form-floating mb-3">
                                <input
                                  type="date"
                                  name="fechaI1"
                                  class="form-control"
                                  placeholder="name@example.com"
                                  required
                                />
                                <label for="floatingInput"
                                  >Fecha aplicación del control</label
                                >
                              </div>
                            </div>
                          </div>
                          <input
                            type="hidden"
                            name="csrf_token"
                            value="{{ csrf_token() }}"
                          />
                          <input type="hidden" name="id" value="{{trats[0]}}" />
                          <input
                            type="hidden"
                            name="id_hoja"
                            value="{{id_hoja}}"
                          />
                          <input
                            type="hidden"
                            name="diagnostico"
                            value="{{pred_output}}"
                          />
                          <input
                            type="hidden"
                            name="porcen_fia"
                            value="{{porc}}"
                          />
                          <input
                            type="hidden"
                            name="imagen_hoja"
                            value="{{ti[0][2]}}"
                          />
                          <!--<input type="submit" class="btn btn-primary"  value="Seleccionar" disabled>-->
                          <button
                            type="submit"
                            name="selControl"
                            class="btn btn-primary"
                          >
                            Seleccionar
                          </button>
                        </form>

                        {% endif %}
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            {% endfor %}
          </div>
        </div>
      </div>
      <div class="col"></div>
    </div>
  </div>
</section>
<div
  class="modal fade"
  id="exampleModal"
  tabindex="-1"
  aria-labelledby="exampleModalLabel"
  aria-hidden="true"
>
  <div class="modal-dialog modal-xl modal-dialog-scrollable">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="exampleModalLabel">
          Resultados del diagnóstico
        </h1>
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="modal"
          aria-label="Close"
        ></button>
      </div>
      <div class="modal-body">
        <div class="container text-center">
          <div class="row justify-content-between">
            <div class="col">
              <div class="card">
                <img
                  src="./static/images/{{ foto_base }}"
                  alt="User Image"
                  width="auto"
                />
                <div class="card-body">
                  <p class="card-text">Foto Base</p>
                </div>
              </div>
            </div>
            <div class="col">
              <div class="card">
                <img
                  src="data:image/jpeg;base64,{{ img_tomate }}"
                  alt="User Image"
                  width="auto"
                />

                <div class="card-body">
                  <p class="card-text">Foto Ingresada</p>
                </div>
              </div>
            </div>
          </div>
        </div>

        <br />
        <div class="row">
          <div class="container text-center">
            <div class="row justify-content-evenly">
              <div class="col-11">
                <div class="form-floating mb-3">
                  <input
                    value="{{pred_output}}"
                    readonly
                    type="text"
                    class="form-control"
                  />
                  <label for="floatingInput">Nombre de la enfermedad</label>
                </div>
                <div class="form-floating mb-3">
                  <input
                    value="{{porc}}"
                    type="text"
                    readonly
                    class="form-control"
                    id="floatingInput"
                    placeholder="name@example.com"
                  />
                  <label for="floatingInput"
                    >Porcentaje de Fiabilidad en el resultado</label
                  >
                </div>
                <div class="form-floating mb-3">
                  <textarea
                    type="text"
                    readonly
                    class="form-control"
                    style="height: 10rem; text-align: justify"
                    placeholder="name@example.com"
                  >
{{datos_plaga[2]}}</textarea
                  >
                  <label for="floatingInput"
                    >Descripción de lo encontrado en el tomate</label
                  >
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
          Cerrar
        </button>
      </div>
    </div>
  </div>
</div>

{% endblock %}
